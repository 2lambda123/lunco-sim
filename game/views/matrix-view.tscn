[gd_scene load_steps=46 format=2]

[ext_resource path="res://controls/spacecraft/spacecraft-controller.tscn" type="PackedScene" id=1]
[ext_resource path="res://addons/lunco-cameras/gimbal-camera/gimbal-camera.tscn" type="PackedScene" id=2]
[ext_resource path="res://maps/demo-map.tscn" type="PackedScene" id=3]
[ext_resource path="res://views/code/Avatar.gd" type="Script" id=4]
[ext_resource path="res://views/code/world.gd" type="Script" id=5]
[ext_resource path="res://ui/spacecraft-ui.tscn" type="PackedScene" id=6]
[ext_resource path="res://player/player.tscn" type="PackedScene" id=7]
[ext_resource path="res://controls/operator/operator.tscn" type="PackedScene" id=8]
[ext_resource path="res://addons/lunco-content/spacex-starship/source/SpaceX_Starship.tscn" type="PackedScene" id=9]
[ext_resource path="res://addons/imjp94.yafsm/src/StateMachinePlayer.gd" type="Script" id=10]
[ext_resource path="res://addons/imjp94.yafsm/src/states/State.gd" type="Script" id=11]
[ext_resource path="res://addons/imjp94.yafsm/src/states/StateMachine.gd" type="Script" id=12]
[ext_resource path="res://addons/imjp94.yafsm/src/transitions/Transition.gd" type="Script" id=13]
[ext_resource path="res://addons/imjp94.yafsm/src/conditions/Condition.gd" type="Script" id=14]
[ext_resource path="res://addons/lunco-cameras/spring-arm-camera/spring-arm-camera.tscn" type="PackedScene" id=15]

[sub_resource type="Resource" id=11]
script = ExtResource( 11 )
__meta__ = {
"graph_offset": Vector2( 350, 294.5 )
}
name = "Entry"

[sub_resource type="Resource" id=12]
script = ExtResource( 11 )
__meta__ = {
"graph_offset": Vector2( 670, 434.5 )
}
name = "Idle"

[sub_resource type="Resource" id=18]
script = ExtResource( 11 )
__meta__ = {
"graph_offset": Vector2( -30, -5.5 )
}
name = "Param thrust"

[sub_resource type="Resource" id=19]
script = ExtResource( 11 )
__meta__ = {
"graph_offset": Vector2( -30, -5.5 )
}
name = "Param thrust2"

[sub_resource type="Resource" id=40]
script = ExtResource( 11 )
__meta__ = {
"graph_offset": Vector2( -30, -5.5 )
}
name = "Param thrust3"

[sub_resource type="Resource" id=41]
script = ExtResource( 11 )
__meta__ = {
"graph_offset": Vector2( -30, -5.5 )
}
name = "Param thrust4"

[sub_resource type="Resource" id=13]
script = ExtResource( 11 )
__meta__ = {
"graph_offset": Vector2( 647, 74.5 )
}
name = "Param: thrust"

[sub_resource type="Resource" id=14]
script = ExtResource( 13 )
from = "Entry"
to = "Idle"
conditions = {
}

[sub_resource type="Resource" id=20]
script = ExtResource( 12 )
name = ""
states = {
"Entry": SubResource( 11 ),
"Idle": SubResource( 12 ),
"Param thrust": SubResource( 18 ),
"Param thrust2": SubResource( 19 ),
"Param thrust3": SubResource( 40 ),
"Param thrust4": SubResource( 41 ),
"Param: thrust": SubResource( 13 )
}
transitions = {
"Entry": {
"Idle": SubResource( 14 )
}
}

[sub_resource type="SpatialMaterial" id=10]
albedo_color = Color( 0.619608, 0.172549, 0.172549, 1 )

[sub_resource type="SphereMesh" id=16]
material = SubResource( 10 )

[sub_resource type="Gradient" id=17]
offsets = PoolRealArray( 0.202247, 0.890851 )

[sub_resource type="Resource" id=21]
script = ExtResource( 11 )
__meta__ = {
"graph_offset": Vector2( 370, 154.5 )
}
name = "Entry"

[sub_resource type="Resource" id=31]
script = ExtResource( 11 )
__meta__ = {
"graph_offset": Vector2( 488.5, 434.5 )
}
name = "Operator"

[sub_resource type="Resource" id=22]
script = ExtResource( 11 )
__meta__ = {
"graph_offset": Vector2( 688, 94.5 )
}
name = "Player"

[sub_resource type="Resource" id=23]
script = ExtResource( 11 )
__meta__ = {
"graph_offset": Vector2( 902, 276.5 )
}
name = "Spacecraft"

[sub_resource type="Resource" id=25]
script = ExtResource( 13 )
from = "Entry"
to = "Player"
conditions = {
}

[sub_resource type="Resource" id=38]
script = ExtResource( 14 )
name = "player"

[sub_resource type="Resource" id=39]
script = ExtResource( 13 )
from = "Operator"
to = "Player"
conditions = {
"player": SubResource( 38 )
}

[sub_resource type="Resource" id=36]
script = ExtResource( 14 )
name = "spacecraft"

[sub_resource type="Resource" id=37]
script = ExtResource( 13 )
from = "Operator"
to = "Spacecraft"
conditions = {
"spacecraft": SubResource( 36 )
}

[sub_resource type="Resource" id=32]
script = ExtResource( 14 )
name = "operator"

[sub_resource type="Resource" id=33]
script = ExtResource( 13 )
from = "Player"
to = "Operator"
conditions = {
"operator": SubResource( 32 )
}

[sub_resource type="Resource" id=26]
script = ExtResource( 14 )
name = "spacecraft"

[sub_resource type="Resource" id=27]
script = ExtResource( 13 )
from = "Player"
to = "Spacecraft"
conditions = {
"spacecraft": SubResource( 26 )
}

[sub_resource type="Resource" id=34]
script = ExtResource( 14 )
name = "operator"

[sub_resource type="Resource" id=35]
script = ExtResource( 13 )
from = "Spacecraft"
to = "Operator"
conditions = {
"operator": SubResource( 34 )
}

[sub_resource type="Resource" id=28]
script = ExtResource( 14 )
name = "player"

[sub_resource type="Resource" id=29]
script = ExtResource( 13 )
from = "Spacecraft"
to = "Player"
conditions = {
"player": SubResource( 28 )
}

[sub_resource type="Resource" id=30]
script = ExtResource( 12 )
name = ""
states = {
"Entry": SubResource( 21 ),
"Operator": SubResource( 31 ),
"Player": SubResource( 22 ),
"Spacecraft": SubResource( 23 )
}
transitions = {
"Entry": {
"Player": SubResource( 25 )
},
"Operator": {
"Player": SubResource( 39 ),
"Spacecraft": SubResource( 37 )
},
"Player": {
"Operator": SubResource( 33 ),
"Spacecraft": SubResource( 27 )
},
"Spacecraft": {
"Operator": SubResource( 35 ),
"Player": SubResource( 29 )
}
}

[node name="Matrix" type="Node"]

[node name="World" type="Node" parent="."]
script = ExtResource( 5 )

[node name="Player" parent="World" instance=ExtResource( 7 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.783736, 0 )
camera = NodePath("PlayerCam")

[node name="PlayerCam" parent="World/Player" instance=ExtResource( 15 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 2.22763, 0 )
CAMERA_CONTROLLER_ROTATION_SPEED = 7.0
camera_basis = Vector3( 0, 3, 0 )

[node name="Commands" type="Node" parent="World/Player/PlayerCam"]

[node name="SpacecraftControl" parent="World" instance=ExtResource( 1 )]
transform = Transform( 1, 0, 1.11022e-16, 0, -0.0551419, 0.998479, 0, -0.998479, -0.0551419, 0, 35.4788, 0 )

[node name="State" type="Node" parent="World/SpacecraftControl"]
script = ExtResource( 10 )
state_machine = SubResource( 20 )

[node name="SpaceX_Starship" parent="World/SpacecraftControl" instance=ExtResource( 9 )]

[node name="Exhause" type="CPUParticles" parent="World/SpacecraftControl"]
transform = Transform( 0.0422594, 4.66645e-09, 0.999107, 2.23517e-08, 1, 6.98492e-10, -0.999107, -4.47035e-08, 0.0422594, -0.000134713, 10.7242, -32.1456 )
emitting = false
amount = 40
lifetime = 1.78
mesh = SubResource( 16 )
initial_velocity = 8.7
color_ramp = SubResource( 17 )

[node name="SpacecraftCam" parent="World" instance=ExtResource( 2 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -4.23516e-22, -3.8147e-06, 1.19209e-07 )
distance = 20.0

[node name="Operator" parent="World" instance=ExtResource( 8 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0.779129, 0, 11.4547 )

[node name="OperatorCam" parent="World/Operator" instance=ExtResource( 15 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -0.779129, 3.01137, -11.4547 )
target = NodePath("..")
CAMERA_CONTROLLER_ROTATION_SPEED = 7.0
camera_basis = Vector3( 0, 3, 0 )

[node name="Commands" type="Node" parent="World/Operator/OperatorCam"]

[node name="Terrain" parent="World" instance=ExtResource( 3 )]

[node name="Avatar" type="Node" parent="."]
script = ExtResource( 4 )
PlayerCam = NodePath("../World/Player/PlayerCam")
SpacecraftCam = NodePath("../World/SpacecraftCam")
OperatorCam = NodePath("../World/Operator/OperatorCam")
Player = NodePath("../World/Player")
Spacecraft = NodePath("../World/SpacecraftControl")
Operator = NodePath("../World/Operator")
SpacecarftUI = NodePath("UI/SpacecraftUI")

[node name="State" type="Node" parent="Avatar"]
script = ExtResource( 10 )
state_machine = SubResource( 30 )

[node name="UI" type="Node" parent="Avatar"]

[node name="SpacecraftUI" parent="Avatar/UI" instance=ExtResource( 6 )]
target = NodePath("")

[connection signal="transited" from="Avatar/State" to="Avatar" method="_on_State_transited"]
